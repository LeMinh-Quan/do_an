create database my_db;
use my_db;

create table users(
    maKH varchar(20) primary key,
    HoTen varchar(255),
    email varchar(255),
    pass varchar(200),
    SDT char(10),
    VaiTro enum('admin','user') default 'user'
);
CREATE TABLE DiaChi ( 
MaKH VARCHAR(20) primary key, 
DiaChiGiaoHang ENUM('Nha', 'CongTy', 'Khac') DEFAULT 'Nha',
ChiTietDiaChi VARCHAR(255) NOT NULL,
ThanhPho VARCHAR(100),
QuanHuyen VARCHAR(100), 
PhuongXa VARCHAR(100), 
GhiChu VARCHAR(255)
);

alter table DiaChi
add constraint fk_dc FOREIGN KEY (MaKH) REFERENCES users(maKH);
/*gio hang*/
create table Cart(
    MaCart char(20) primary key,
    userid varchar(20),
    ngaytao date
);

alter table Cart
add constraint fk_c_u foreign key (userid) references users(maKH);

create table SanPham(
    MaSP char(10) primary key,
    TenSP varchar(255),
    Loai varchar(20),
    ThuongHieu varchar(100),
    MoTa varchar(255),
    GiaBan decimal(10,0),
    SoLuong int check(SoLuong>0)
);

create table CT_cart(
    MaCart char(20),
    MaSP char(10),
    SoLuong int check(SoLuong>0),
    Gia decimal(10,0)
);

alter table CT_cart
add constraint fk_ct_c foreign key (MaCart) references Cart(MaCart),
add constraint fk_ct_sp foreign key (MaSP) references SanPham(MaSP);

create table DonHang(
    MaDH char(10) primary key,
    MaKH varchar(20),
    NgayDat date,
    TongTien decimal(10,0),
    TrangThai enum('huy','Cho xac nhan','Dang Giao','Da Giao') default 'Cho xac nhan'
);

alter table DonHang
add constraint fk_dh_kh foreign key (MaKH) references users(maKH);

create table CT_donhang(
    MaDH char(10),
    MaSP char(10),
    SoLuong int check(SoLuong>0),
    DonGia decimal(10,0),
    ThanhTien decimal(10,0)
);

alter table CT_donhang
add constraint fk_ct_hd foreign key (MaDH) references DonHang(MaDH),
add constraint fk_ctdh_sp foreign key (MaSP) references SanPham(MaSP);

create table ThanhToan(
    MaTT char(10) primary key,
    MaDH char(10),
    PhuongThuc ENUM('Chuyen khoan', 'Vi dien tu', 'The tin dung', 'Tien mat') DEFAULT 'Tien mat',
    Ngayvagio datetime,
    TrangThai enum('Chua Thanh Toan','Da Thanh Toan') default 'Chua Thanh Toan'
);

alter table ThanhToan
add constraint fk_tt_dh foreign key (MaDH) references DonHang(MaDH);

create table admin(
    TKadmin varchar(20) primary key,
    PASS varchar(255),
    tenadmin varchar(200),
    email varchar(255)
);
	CREATE TABLE BaoCao (
    MaBC CHAR(10) PRIMARY KEY,
    NgayBaoCao DATETIME DEFAULT CURRENT_TIMESTAMP,
    TongDon INT,
    TongDoanhThu DECIMAL(12,0),
    SanPhamBanChay VARCHAR(255),
    NguoiMuaNhieu VARCHAR(255),
    GhiChu VARCHAR(255)
);

alter table SanPham 
add constraint ck_gia check(GiaBan>0);

alter table CT_Cart 
add CONSTRAINT pk_ma PRIMARY key (MaCart,MaSP);

alter table CT_donhang
add constraint pk_cthd primary key(MaDH,MaSP);

alter table admin
add constraint u_ad UNIQUE (email);

create table MoTa(
 MaSP char(10) primary key,
 CPU varchar(20),
 RAM varchar(20),
 ROM varchar(20),
 GPU varchar(20),
 ManHinh varchar(20),
 HeDieuHanh varchar(20),
 MauSac VARCHAR(20),
    ChiTiet varchar(255)
);
CREATE TABLE CPU (
    MaCPU VARCHAR(20) PRIMARY KEY,
    TenCPU VARCHAR(100) NOT NULL,
    MoTa TEXT
);

CREATE TABLE RAM (
    MaRAM VARCHAR(20) PRIMARY KEY,
    DungLuong VARCHAR(50) NOT NULL,
    LoaiRAM VARCHAR(50),
    TocDo VARCHAR(50)
);
CREATE TABLE ROM (
    MaROM VARCHAR(20) PRIMARY KEY,
    DungLuong VARCHAR(50) NOT NULL,
    LoaiROM VARCHAR(50),
    MoTa TEXT
);
CREATE TABLE GPU (
    MaGPU VARCHAR(20) PRIMARY KEY,
    TenGPU VARCHAR(100) NOT NULL,
    LoaiGPU VARCHAR(50),
    MoTa TEXT
);
CREATE TABLE ManHinh (
    MaMH VARCHAR(20) PRIMARY KEY,
    KichThuoc VARCHAR(50),
    DoPhanGiai VARCHAR(50),
    TanSo VARCHAR(50),
    CongNghe VARCHAR(100)
);
CREATE TABLE HeDieuHanh (
    MaHDH VARCHAR(20) PRIMARY KEY,
    TenHDH VARCHAR(100) NOT NULL,
    PhienBan VARCHAR(50)
);
CREATE TABLE MauSac (
    MaMau VARCHAR(20) PRIMARY KEY,
    TenMau VARCHAR(50) NOT NULL,
    MaHex VARCHAR(10)
);


ALTER TABLE MoTa
ADD CONSTRAINT fk_mt FOREIGN KEY (MaSP) REFERENCES SanPham(MaSP),
ADD CONSTRAINT fk_cpu FOREIGN KEY (CPU) REFERENCES CPU(MaCPU),
ADD CONSTRAINT fk_ram FOREIGN KEY (RAM) REFERENCES RAM(MaRAM),
ADD CONSTRAINT fk_rom FOREIGN KEY (ROM) REFERENCES ROM(MaROM),
ADD CONSTRAINT fk_gpu FOREIGN KEY (GPU) REFERENCES GPU(MaGPU),
ADD CONSTRAINT fk_mh FOREIGN KEY (ManHinh) REFERENCES ManHinh(MaMH),
ADD CONSTRAINT fk_hdh FOREIGN KEY (HeDieuHanh) REFERENCES HeDieuHanh(MaHDH),
ADD CONSTRAINT fk_mau FOREIGN KEY (MauSac) REFERENCES MauSac(MaMau);

INSERT INTO SanPham (MaSP, TenSP, Loai, ThuongHieu, MoTa, GiaBan, SoLuong)
VALUES
('AC01', 'Acer Nitro 5', 'Laptop', 'ACER', 'Laptop gaming phổ thông', 22990000, 12),
('AC02', 'Acer Aspire 7', 'Laptop', 'ACER', 'Học tập và chơi game nhẹ', 17990000, 13),
('AC03', 'Acer Swift 3', 'Laptop', 'ACER', 'Mỏng nhẹ, pin trâu', 21990000, 10),
('AC04', 'Acer Predator Helios 18', 'Laptop', 'ACER', 'Gaming cao cấp', 38990000, 8),
('AC05', 'Acer Spin 5', 'Laptop', 'ACER', 'Làm việc, xoay gập', 25990000, 6),
('AP01', 'MacBook Air M1', 'Laptop', 'APPLE', 'Hiệu năng ổn, pin lâu', 24990000, 8),
('AP02', 'MacBook Pro M1', 'Laptop', 'APPLE', 'Hiệu năng cao', 26990000, 5),
('AP03', 'MacBook Air M2', 'Laptop', 'APPLE', 'Thiết kế mỏng nhẹ', 29990000, 6),
('AP04', 'MacBook Pro 13 M3', 'Laptop', 'APPLE', 'Cấu hình mạnh', 44990000, 3),
('AP05', 'MacBook Pro 16 M3 Max', 'Laptop', 'APPLE', 'Cao cấp nhất', 64990000, 3);

INSERT INTO MoTa (MaSP, CPU, RAM, ROM, GPU, ManHinh, HeDieuHanh, MauSac, ChiTiet)
VALUES
('AC01', 'CPU01', 'RAM01', 'ROM01', 'GPU01', 'MH01', 'HDH01', 'MAU01', 'Hiệu năng ổn định, phù hợp cho game và học tập.');
INSERT INTO CPU (MaCPU, TenCPU, MoTa)
VALUES
('CPU01', 'Core i5-12500H', 'Hiệu năng tầm trung cho gaming'),
('CPU02', 'Ryzen 5 5625U', 'Tiết kiệm điện, hiệu năng ổn'),
('CPU03', 'Core i5-1335U', 'CPU thế hệ mới, mạnh mẽ'),
('CPU04', 'Core i9-13900HX', 'Hiệu năng cao cho gaming nặng'),
('CPU05', 'Core i7-1355U', 'Hiệu quả cho công việc'),
('CPU06', 'Apple M1', 'Chip Apple hiệu năng tốt'),
('CPU07', 'Apple M1 Pro', 'Chip Apple cao cấp'),
('CPU08', 'Apple M2', 'Hiệu suất cải thiện so với M1'),
('CPU09', 'Apple M3', 'Chip mạnh cho dân chuyên nghiệp'),
('CPU10', 'Apple M3 Max', 'Hiệu năng đỉnh cao');

-- BẢNG RAM
INSERT INTO RAM (MaRAM, DungLuong, LoaiRAM, TocDo)
VALUES
('RAM01', '16GB', 'DDR4', '3200MHz'),
('RAM02', '32GB', 'DDR5', '4800MHz'),
('RAM03', '8GB', 'DDR4', '2666MHz');

-- BẢNG ROM
INSERT INTO ROM (MaROM, DungLuong, LoaiROM, MoTa)
VALUES
('ROM01', '512GB', 'SSD', 'Dung lượng vừa đủ cho học tập'),
('ROM02', '1TB', 'SSD', 'Dung lượng cao, tốc độ nhanh');

-- BẢNG GPU
INSERT INTO GPU (MaGPU, TenGPU, LoaiGPU, MoTa)
VALUES
('GPU01', 'RTX 3050', 'NVIDIA', 'Card đồ họa tầm trung'),
('GPU02', 'GTX 1650', 'NVIDIA', 'Card phổ thông cho game nhẹ'),
('GPU03', 'Intel Iris Xe', 'Intel', 'Đồ họa tích hợp'),
('GPU04', 'RTX 4080', 'NVIDIA', 'Card cao cấp cho gaming'),
('GPU05', 'Intel Iris Xe', 'Intel', 'Đồ họa tích hợp cho công việc'),
('GPU06', 'GPU 7 nhân', 'Apple', 'GPU tích hợp M1'),
('GPU07', 'GPU 10 nhân', 'Apple', 'GPU mạnh trên M1 Pro'),
('GPU08', 'GPU 8 nhân', 'Apple', 'Hiệu năng cân đối'),
('GPU09', 'GPU 10 nhân', 'Apple', 'Hiệu năng cao M3'),
('GPU10', 'GPU 40 nhân', 'Apple', 'Hiệu năng đỉnh M3 Max');

-- BẢNG MÀN HÌNH
INSERT INTO ManHinh (MaMH, KichThuoc, DoPhanGiai, TanSo, CongNghe)
VALUES
('MH01', '15.6 inch', 'FHD', '144Hz', 'IPS'),
('MH02', '15.6 inch', 'FHD', '', 'IPS'),
('MH03', '14 inch', 'FHD', '', 'IPS'),
('MH04', '18 inch', 'QHD+', '240Hz', 'Mini LED'),
('MH05', '13.3 inch', 'FHD', '', 'IPS'),
('MH06', '13.3 inch', 'Retina', '', 'LED'),
('MH07', '13.3 inch', 'Retina', '', 'LED'),
('MH08', '13.6 inch', 'Retina', '', 'LED'),
('MH09', '14 inch', 'Liquid Retina', '', 'XDR'),
('MH10', '16 inch', 'Liquid Retina XDR', '', 'XDR');

-- BẢNG HỆ ĐIỀU HÀNH
INSERT INTO HeDieuHanh (MaHDH, TenHDH, PhienBan)
VALUES
('HDH01', 'Windows', '11'),
('HDH02', 'Windows', '11 Pro'),
('HDH03', 'macOS', 'Sonoma'),
('HDH04', 'macOS', 'Sequoia');

-- BẢNG MÀU SẮC
INSERT INTO MauSac (MaMau, TenMau, MaHex)
VALUES
('MAU01', 'Đen', '#000000'),
('MAU02', 'Xám', '#808080'),
('MAU03', 'Bạc', '#C0C0C0'),
('MAU04', 'Xanh', '#1E90FF'),
('MAU05', 'Bạc', '#D9D9D9'),
('MAU06', 'Bạc', '#E0E0E0'),
('MAU07', 'Xám', '#A9A9A9'),
('MAU08', 'Vàng', '#FFD700'),
('MAU09', 'Xám', '#C0C0C0'),
('MAU10', 'Bạc', '#F0F0F0');


insert into admin values
('admin','202cb962ac59075b964b07152d234b70','QUAN','0306241143@caothang.edu.vn'),
('admin2','202cb962ac59075b964b07152d234b70','SANG','0306241144@caothang.edu.vn'),
('admin3','202cb962ac59075b964b07152d234b70','TAI','0306241145@caothang.edu.vn');
