	create database my_db;
use my_db;
create table users(
    maKH varchar(20)PRIMARY KEY,
    HoTen varchar(255),
    email varchar(255),
    pass varchar(10),
    SDT char(10),
    DiaChi varchar(255),
    VaiTro enum('admin','user')DEFAULT 'user'
    );
create table Cart(
        MaCart char(20) PRIMARY key,
    userid varchar(20),
    ngaytao date
        );
        
alter table Cart
add constraint fk_c_u FOREIGN key (userid) REFERENCES users(maKH);
create table SanPham(
    MaSP char(10) PRIMARY key,
    TenSP varchar(255),
    Loai varchar(20)/*laptop or pc*/,
    ThuongHieu varchar(100),
    MoTa varchar(255),
    GiaBan  DECIMAL(10,0),
    SoLuong int check(SoLuong>0)
    );
 CREATE table CT_cart(
            MaCart char(20),
            MaSP char(10),
     		SoLuong int check (SoLuong>0),
     Gia  DECIMAL(10,0)
            );
            
         ALTER TABLE CT_cart
         add CONSTRAINT fk_ct_c foreign key (MaCart) REFERENCES Cart(MaCart),
         add constraint fk_ct_sp foreign key(MaSP) REFERENCES SanPham(MaSP);
         create table DonHang(
             MaDH char(10) primary key,
    MaKH varchar(20),
             NgayDat date,
             TongTien  DECIMAL(10,0),
             TrangThai enum('huy','Cho xac nhan','Dang Giao','Da Giao')DEFAULT 'Cho xac nhan'
             );

create table CT_donhang(
    MaDH char(10),
    MaSP char(10),
    SoLuong int,
    DonGia  DECIMAL(10,0),
    ThanhTien  DECIMAL(10,0)
    );
alter table CT_donhang
add constraint ck_sl check(SoLuong>0);
alter table CT_donhang
add constraint fk_ct_hd foreign key (MaDH) REFERENCES DonHang(MaDH);
alter table CT_donhang
add constraint fk_ctdh_sp foreign key(MaSP) references SanPham(MaSP);

create table ThanhToan(
    MaTT char(10),
    MaDH char(10),
    PhuongThuc enum('Chuyen khoan','Tien Mat')DEFAULT 'Tien Mat',
     Ngayvagio datetime,
   TrangThai enum('Chua Thanh Toan','Da Thanh toan') DEFAULT'Chua Thanh Toan'
);
    
  ALTER table ThanhToan
  add constraint fk_tt_dh FOREIGN key(MaDH) REFERENCES DonHang(MaDH);
create table admin(
TKadmin varchar(20) primary key,
PASS varchar(20),
tenadmin varchar(200),
email varchar(255),
);
